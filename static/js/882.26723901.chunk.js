"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[882],{73332:function(e,t,n){n.d(t,{B:function(){return i},a:function(){return r}});var a=n(74569),o=n.n(a),i=o().create({baseURL:"http://finco360.com/",headers:{"content-type":"application/json",UserAgent:"WebAgent","X-TenantID":"finco3"}}),r=o().create({baseURL:"http://finco360.com/",headers:{"content-type":"application/json",UserAgent:"WebAgent","X-TenantID":"finco3"}})},65482:function(e,t,n){n.d(t,{LP:function(){return f},jG:function(){return d},sd:function(){return p}});var a=n(1413),o=n(34045),i=n(35125),r=n(31052),l=n.n(r),c=n(85062),s=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],f=function(){var e=JSON.parse(localStorage.getItem("fincoLoginDetails")).token;return e||!1},d=function(e){var t,n=e.data,o=e.pdfTitle,r=e.pdfName,c=e.columns;console.log("downloadPdf called",c),(t=c.length<=7?new i.default:new i.default("p","mm",[430,430])).text(o,15,10),l()(t,{body:n,columns:c.map((function(e){return(0,a.Z)((0,a.Z)({},e),{},{dataKey:e.field})})),theme:"grid",styles:{fontSize:10,theme:"grid"},headStyles:{lineWidth:.5,fontSize:10,fontStyle:"bold",fillColor:"#f9c46b",lineColor:"#ffffff"},bodyStyles:{fillColor:"#e3e3e3",lineWidth:.5,lineColor:"#ffffff"}}),t.save(r)};function u(e){var t=e.finalData,n=e.columnLength,a=o.P6.json_to_sheet(t,{skipHeader:!0}),i=o.P6.book_new();o.P6.book_append_sheet(i,a,"Staff List");var r=o.cW(i,{bookType:"xlsx",type:"array"});return function(e,t){return c.fromDataAsync(e).then((function(e){return e.sheets().forEach((function(e){e.usedRange().style({fontFamily:"Arial",verticalAlignment:"center"}),s.forEach((function(t){e.column(t).width(18)})),e.range(t.titleRange).merged(!0).style({bold:!0,horizontalAlignment:"left",verticalAlignment:"center",fill:"dee0e6",border:{style:"bold",color:"000000"}}),e.range(t.theadRange).style({fill:"edd2cb",bold:!1,horizontalAlignment:"center",fontSize:14}),e.range(t.tbodyRange).style({horizontalAlignment:"left",fill:"f1e8e6",fontSize:10}),e.range(t.tableRange).style({border:{style:"thin",color:"000000",direction:"both"}})})),e.outputAsync().then((function(e){return URL.createObjectURL(e)}))}))}(new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),{titleCell:"A2",titleRange:"A1:".concat(s[n-1],"2"),theadRange:"A3:".concat(s[n-1],"3"),tbodyRange:"A4:".concat(s[n-1]).concat(t.length),tableRange:"A3:".concat(s[n-1]).concat(t.length)})}var p=function(e){var t=e.data,n=e.sheetName,o=e.fileName,i=[];for(var r in t[0])i.push(r);for(var l={},c=[],f=0;f<i.length;f++){var d=s[f];l[d]=i[f]}c.push(l);var p=[].concat([{A:"Unique Cooperative Ltd."},{}],c),h={};t.forEach((function(e,t){for(var n in l){var o=l[n];h[n]=e[o]}p.push((0,a.Z)({},h))})),u({finalData:p,columnLength:i.length,sheetName:n}).then((function(e){var t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("download",o),t.click(),t.remove()}))}},73882:function(e,t,n){n.r(t),n.d(t,{default:function(){return v}});var a=n(74165),o=n(15861),i=n(1413),r=n(70885),l=n(78983),c=n(72791),s=n(73332),f=n(65482),d=n(9098),u=n(62711),p=n(59434),h=n(80184),m=function(e){var t=e.data,n=[{title:"Id",field:"StaffId"},{title:"FirstName",field:"Firstname"},{title:"LastName",field:"Lastname"},{title:"Code",field:"Code"},{title:"Dob",field:"Dob"},{title:"MaritalStatus",field:"MaritalStatus"},{title:"Mobile",field:"Mobile"},{title:"Email",field:"Email"},{title:"BloodGroup",field:"BloodGroup"},{title:"JoinDate",field:"JoinDate"},{title:"JobType",field:"JobType"},{title:"StaffGroup",field:"StaffGroup"},{title:"PanNo",field:"PanNo"},{title:"Gender",field:"Gender"},{title:"District",field:"District"},{title:"Vdc",field:"Vdc"},{title:"Tole",field:"Tole"},{title:"WardNo",field:"WardNo"}],a={data:t,sheetName:"Records",fileName:"StaffList.xlsx"},o={data:t,pdfTitle:"Staff Details:",pdfName:"StaffList.pdf",columns:n},i=(0,p.v9)((function(e){return e.dropDownData.selected.name})),r="Office Name:".concat(i);return(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(l.KB,{className:"p-2",children:(0,h.jsx)(d.ZP,{title:r,data:t,columns:n,options:{headerStyle:{background:"rgb(84,142,239)",color:"white",fontWeight:"bold",position:"sticky",top:0},maxBodyHeight:"650px",sorting:!0,columnsButton:!0,paginationType:"stepped",showFirstLastPageButtons:!0},actions:[{icon:function(){return(0,h.jsx)(u.JO,{icon:"mdi:file-excel",width:"20",inline:!0,id:1,color:"green"})},tooltip:"Export To Excel",isFreeAction:!0,onClick:function(e){(0,f.sd)(a)}},{icon:function(){return(0,h.jsx)(u.JO,{icon:"mdi:file-pdf-box",color:"red",width:"20",id:1,inline:!0})},tooltip:"Download as pdf",isFreeAction:!0,onClick:function(e){(0,f.jG)(o)}}]})})})},b=n(24846),g=n(62412),v=function(){var e=(0,c.useState)([]),t=(0,r.Z)(e,2),n=t[0],d=t[1],u=(0,c.useState)([]),v=(0,r.Z)(u,2),x=v[0],y=v[1],S=(0,c.useState)({JobStatusID:"",Description:""}),D=(0,r.Z)(S,2),j=D[0],w=D[1],k=(0,p.I0)(),A=(0,p.v9)((function(e){return e.dropDownData.selected.id})),N=(0,p.v9)((function(e){var t;return null===(t=e.jobStatus.selected)||void 0===t?void 0:t.JobStatusID})),L=(0,f.LP)();return(0,c.useEffect)((function(){var e=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.a.get("/finco/api/job/status/list",{headers:{token:"".concat(L)}});case 3:t=e.sent,y(t.data),w({JobStatusID:t.data[0].JobStatusID,Description:t.data[0].Description}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),alert(e.t0.response.data.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();e()}),[]),(0,c.useEffect)((function(){k({type:"getJobStatus",selected:j})}),[j]),(0,c.useEffect)((function(){var e=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.a.get("/finco/api/auth/staff/list?officeId=".concat(A,"&statusId=").concat(N||1),{headers:{token:"".concat(L)}});case 3:t=e.sent,d(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[A,N]),(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(l.KB,{children:(0,h.jsx)(l.rb,{children:(0,h.jsx)(l.b7,{xs:"12",children:(0,h.jsxs)(l.xH,{style:{background:"#60779f"},children:[(0,h.jsxs)(l.bn,{component:"h5",children:[(0,h.jsx)(b.Z,{icon:g.E,customClassName:"nav-icon",height:30,width:50,style:{color:"white"}}),(0,h.jsx)("span",{className:"d-inline-block text-white",children:"Staff Details"})]}),(0,h.jsxs)(l.sl,{children:[(0,h.jsxs)("div",{className:"m-1 p-2 d-flex justify-content-center",style:{borderRadius:"5px",background:"#1a3eb4",color:"white"},children:[(0,h.jsx)(l.L8,{className:"form-label pt-2 px-2 ",style:{fontSize:"1rem",fontWeight:"bold"},children:"Job status:"}),(0,h.jsx)(l.LX,{size:"sm",onChange:function(e){var t=e.target.value.split("!!")[0],n=e.target.value.split("!!")[1];w((0,i.Z)((0,i.Z)({},j),{},{JobStatusID:t,Description:n}))},className:"w-25",children:x.map((function(e){var t=e.JobStatusID,n=e.Description;return(0,h.jsx)("option",{value:"".concat(t,"!!").concat(n),children:n},t)}))})]}),(0,h.jsx)(m,{data:n,jobs:x})]})]})})})})})}}}]);
//# sourceMappingURL=882.26723901.chunk.js.map